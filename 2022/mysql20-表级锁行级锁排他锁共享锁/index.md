# 【MySQL】20 - 表级锁、行级锁、排他锁、共享锁



## 表级锁、行级锁


- 表级锁：对整张表加锁。开销小，加锁快，不会出现死锁；锁粒度大，发生锁冲突的概率高，并发度低；
- 行级锁：对某行记录加锁。开销大，加锁慢，会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度高。

行级锁开销大、加锁慢的原因在于，表级锁只需直接锁住一张表即可，而行级锁需要找到对应的记录，需要搜索索引。


## 排他锁、共享锁

- 排它锁（Exclusive），又称为X锁，写锁；
- 共享锁（Shared），又称为S锁，读锁。

X和S锁之间有以下的关系： SS可以兼容的，XS、SX、XX之间是互斥的。

- 一个事务对数据对象 O 加了 S 锁，可以对 O 进行读取操作但不能进行更新操作。加锁期间其它事务能对O 加 S 锁但不能加 X 锁。
- 一个事务对数据对象 O 加了 X 锁，就可以对 O 进行读取和更新。加锁期间其它事务不能对 O 加任何锁。


显式加锁：`select ... lock in share mode` 强制获取共享锁，`select ... for update` 获取排它锁
