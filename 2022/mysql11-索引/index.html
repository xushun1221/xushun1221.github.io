<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>【MySQL】11 - 索引 | XuShun's Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta name=Description content="XuShun的个人博客，记录学习和生活。"><link rel=prev href=https://xushun1221.github.io/2022/mysql09-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E8%AF%A6%E8%A7%A3/><link rel=next href=https://xushun1221.github.io/2022/mysql10-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/><link rel=canonical href=https://xushun1221.github.io/2022/mysql11-%E7%B4%A2%E5%BC%95/><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta name=twitter:card content="summary"><meta name=twitter:title content="【MySQL】11 - 索引"><meta name=twitter:description content="MySQL 索引 当表中的数据量到达几十万甚至上百万的时候，SQL查询所花费的时间会很长，导致业务超时出错，此时就需要用索引来加速SQL查询。 索引解决的"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"【MySQL】11 - 索引","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/xushun1221.github.io\/2022\/mysql11-%E7%B4%A2%E5%BC%95\/"},"image":{"@type":"ImageObject","url":"https:\/\/xushun1221.github.io\/cover.png","width":800,"height":600},"genre":"posts","keywords":"datebase, MySQL","wordcount":3271,"url":"https:\/\/xushun1221.github.io\/2022\/mysql11-%E7%B4%A2%E5%BC%95\/","datePublished":"2022-11-04T00:00:00\x2b00:00","dateModified":"2022-11-04T00:00:00\x2b00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"xushun","logo":{"@type":"ImageObject","url":"https:\/\/xushun1221.github.io\/logo.png","width":127,"height":40}},"description":""}</script><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/css/lib/fontawesome-free/all.min.css></head><body><script>window.isDark=(window.localStorage&&window.localStorage.getItem('theme'))==='dark';window.isDark&&document.body.classList.add('dark-theme');</script><div class=wrapper><nav class=navbar><div class=top-scroll-bar></div><div class=navbar-container><div class="navbar-header animated bounceIn"><a href=https://xushun1221.github.io>XuShun's Blog</a></div><div class=navbar-menu><a class=menu-item href=https://xushun1221.github.io/posts>Posts</a><a class=menu-item href=https://xushun1221.github.io/tags>Tags</a><a class=menu-item href=https://xushun1221.github.io/categories>Categories</a><a class=menu-item href=https://xushun1221.github.io/about>About</a><a href=javascript:void(0); class=theme-switch><i class="fas fa-adjust fa-rotate-180 fa-fw" title="Switch Theme"></i></a></div></div></nav><nav class=navbar-mobile><div class=top-scroll-bar></div><div class=navbar-container><div class=navbar-header><div class="navbar-header-title animated bounceIn"><a href=https://xushun1221.github.io>XuShun's Blog</a></div><div class=menu-toggle id=menu-toggle><span></span><span></span><span></span></div></div><div class=navbar-menu id=mobile-menu><a class=menu-item href=https://xushun1221.github.io/posts>Posts</a><a class=menu-item href=https://xushun1221.github.io/tags>Tags</a><a class=menu-item href=https://xushun1221.github.io/categories>Categories</a><a class=menu-item href=https://xushun1221.github.io/about>About</a><a href=javascript:void(0); class=theme-switch><i class="fas fa-adjust fa-rotate-180 fa-fw" title="Switch Theme"></i></a></div></div></nav><main class=main><div class=container><article class=page><h1 class="post-title animated flipInX">【MySQL】11 - 索引</h1><div class=post-meta><i class="far fa-calendar-alt fa-fw"></i>published on&nbsp;<time datetime=2022-11-04>2022-11-04</time>&nbsp;
<i class="fas fa-pencil-alt fa-fw"></i>about 3271 words&nbsp;<span class=post-category><i class="far fa-folder fa-fw"></i>included in&nbsp;<a href=https://xushun1221.github.io/categories/datebase/>Date base</a>&nbsp;</span></div><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#mysql-索引>MySQL 索引</a></li><li><a href=#索引分类>索引分类</a></li><li><a href=#索引的基本使用>索引的基本使用</a><ul><li><a href=#索引的创建和删除>索引的创建和删除</a></li><li><a href=#索引的执行计划>索引的执行计划</a><ul><li><a href=#explain-查看执行计划>EXPLAIN 查看执行计划</a></li><li><a href=#explain-结果字段说明>EXPLAIN 结果字段说明</a></li></ul></li><li><a href=#测试>测试</a><ul><li><a href=#测试1---有无索引进行where过滤的效率>测试1 - 有无索引进行WHERE过滤的效率</a></li><li><a href=#测试2---什么情况下不会使用索引>测试2 - 什么情况下不会使用索引</a></li></ul></li></ul></li></ul></nav></div></div><div class=post-toc-mobile id=post-toc-mobile><details><summary><div class=post-toc-title><span>Contents</span>
<span><i class="details icon fas fa-angle-down"></i></span></div></summary><div class=post-toc-content><nav id=TableOfContentsMobile><ul><li><a href=#mysql-索引>MySQL 索引</a></li><li><a href=#索引分类>索引分类</a></li><li><a href=#索引的基本使用>索引的基本使用</a><ul><li><a href=#索引的创建和删除>索引的创建和删除</a></li><li><a href=#索引的执行计划>索引的执行计划</a><ul><li><a href=#explain-查看执行计划>EXPLAIN 查看执行计划</a></li><li><a href=#explain-结果字段说明>EXPLAIN 结果字段说明</a></li></ul></li><li><a href=#测试>测试</a><ul><li><a href=#测试1---有无索引进行where过滤的效率>测试1 - 有无索引进行WHERE过滤的效率</a></li><li><a href=#测试2---什么情况下不会使用索引>测试2 - 什么情况下不会使用索引</a></li></ul></li></ul></li></ul></nav></div></details></div><div class=post-content><a class=post-dummy-target id=mysql-索引></a><h2>MySQL 索引</h2><p>当表中的数据量到达几十万甚至上百万的时候，SQL查询所花费的时间会很长，导致业务超时出错，此时就需要用索引来加速SQL查询。</p><p>索引解决的核心问题就是，<strong>提高查询的速度</strong>！</p><p>由于索引也是需要存储成索引文件的，因此对索引的使用也会涉及磁盘I/O操作。如果索引创建过多，使用不当，会造成SQL查询时，进行大量无用的磁盘I/O操作，降低了SQL的查询效率，适得其反，因此，掌握良好的索引创建原则非常重要！</p><a class=post-dummy-target id=索引分类></a><h2>索引分类</h2><p>索引是创建在表上的，是对数据库表中一列或者多列的值进行排序的一种结果。</p><p>物理上，可以将索引分类为，<strong>聚集型索引</strong>和<strong>非聚集型索引</strong>。</p><p>逻辑上，可以将索引分类为：</p><ol><li>普通索引（二级索引），没有任何限制条件，可以给任何类型的字段创建普通索引（创建新表&已创建的表），数量是不限的，一张表的一次sql查询只能用一个索引，这样的sql只能用一个索引<code>where a=1 and b='M'</code>)</li><li>唯一性索引，使用<code>UNIQUE</code>修饰的字段，值不能够重复，主键索引就属于唯一性索引</li><li>主键索引，使用<code>PRIMARY KEY</code>修饰的字段会自动创建索引(MyISAM, InnoDB)</li><li>单列索引，在一个字段上创建索引</li><li>多列索引，在表的多个字段上创建索引 (uid+cid，多列索引必须使用到<strong>第一个列</strong>，才能用到多列索引，否则索引用不上)</li><li>全文索引，使用<code>FULLTEXT</code>参数可以设置全文索引，只支持<code>CHAR</code>，<code>VARCHAR</code>和<code>TEXT</code>类型的字段上，常用于数据量较大的字符串类型上，可以提高查询速度</li></ol><p>实际上，全文索引在真实项目中使用的是较少的，线上项目支持专门的搜索功能，给后台服务器增加专门的搜索引擎，能够支持快速高效的搜索，如elasticsearch，简称es（JAVA），C++开源的搜索引擎，搜狗的workflow。</p><a class=post-dummy-target id=索引的基本使用></a><h2>索引的基本使用</h2><p>使用索引的几个注意点：</p><ol><li>经常作为<code>WHERE</code>过滤条件的字段，要考虑添加索引；</li><li>字符串列创建索引时，尽量规定索引的长度，不要让索引值的长度<code>key_len</code>过长；</li><li>索引字段涉及类型强转、mysql函数调用、表达式计算等，就无法使用索引了。</li></ol><a class=post-dummy-target id=索引的创建和删除></a><h3>索引的创建和删除</h3><p>创建表时指定索引字段：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>test1</span><span class=p>(</span>
    <span class=n>id</span> <span class=nb>INT</span><span class=p>,</span>
    <span class=n>name</span> <span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=p>,</span>
    <span class=n>sex</span> <span class=n>ENUM</span><span class=p>(</span><span class=s1>&#39;</span><span class=s1>male</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;</span><span class=s1>female</span><span class=s1>&#39;</span><span class=p>)</span><span class=p>,</span>
    <span class=k>INDEX</span><span class=p>(</span><span class=n>id</span><span class=p>,</span><span class=n>name</span><span class=p>)</span>
<span class=p>)</span><span class=p>;</span>
</code></pre></td></tr></table></div></div><p>使用<code>PRIMARY KEY</code>或<code>UNIQUE</code>修饰的字段，会自动创建主键索引和唯一键索引。</p><p>为已经创建的表添加索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=k>CREATE</span> <span class=p>[</span><span class=k>UNIQUE</span><span class=p>]</span> <span class=k>INDEX</span> <span class=err>索</span><span class=err>引</span><span class=err>名</span> <span class=k>ON</span> <span class=err>表</span><span class=err>名</span> <span class=p>(</span><span class=err>属</span><span class=err>性</span><span class=err>名</span><span class=p>(</span><span class=k>length</span><span class=p>)</span> <span class=p>[</span><span class=k>ASC</span> <span class=o>|</span> <span class=k>DESC</span><span class=p>]</span><span class=p>)</span><span class=p>;</span>
</code></pre></td></tr></table></div></div><p>如果给字符串字段添加索引，最好使用<code>length</code>表明长度，只要长度可以区分不同字符串即可，使用整个字符串建索引，影响效率（每个索引越长，索引文件就越大，读索引的开销就越大）。</p><p>删除索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=k>DROP</span> <span class=k>INDEX</span> <span class=err>索</span><span class=err>引</span><span class=err>名</span> <span class=k>ON</span> <span class=err>表</span><span class=err>名</span><span class=p>;</span>
</code></pre></td></tr></table></div></div><a class=post-dummy-target id=索引的执行计划></a><h3>索引的执行计划</h3><a class=post-dummy-target id=explain-查看执行计划></a><h4>EXPLAIN 查看执行计划</h4><p>我们可以使用<code>EXPLAIN</code>来查看sql的执行计划，分析索引的执行过程。</p><p>mysql的uer权限表，示例：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=n>mysql</span><span class=o>&gt;</span> <span class=n>use</span> <span class=n>mysql</span><span class=p>;</span>
<span class=n>Reading</span> <span class=k>table</span> <span class=n>information</span> <span class=k>for</span> <span class=k>completion</span> <span class=k>of</span> <span class=k>table</span> <span class=k>and</span> <span class=k>column</span> <span class=k>names</span>
<span class=n>You</span> <span class=n>can</span> <span class=n>turn</span> <span class=k>off</span> <span class=n>this</span> <span class=n>feature</span> <span class=k>to</span> <span class=k>get</span> <span class=n>a</span> <span class=n>quicker</span> <span class=n>startup</span> <span class=k>with</span> <span class=o>-</span><span class=n>A</span>

<span class=k>Database</span> <span class=n>changed</span>
<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=k>Host</span><span class=p>,</span><span class=k>User</span> <span class=k>FROM</span> <span class=k>user</span> <span class=k>WHERE</span> <span class=k>Host</span><span class=o>=</span><span class=s1>&#39;</span><span class=s1>%</span><span class=s1>&#39;</span><span class=err>\</span><span class=k>G</span>
<span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span> <span class=mi>1</span><span class=p>.</span> <span class=k>row</span> <span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span>
           <span class=n>id</span><span class=p>:</span> <span class=mi>1</span>
  <span class=n>select_type</span><span class=p>:</span> <span class=k>SIMPLE</span>
        <span class=k>table</span><span class=p>:</span> <span class=k>user</span>
   <span class=n>partitions</span><span class=p>:</span> <span class=k>NULL</span>
         <span class=k>type</span><span class=p>:</span> <span class=k>ref</span>
<span class=n>possible_keys</span><span class=p>:</span> <span class=k>PRIMARY</span>
          <span class=k>key</span><span class=p>:</span> <span class=k>PRIMARY</span>
      <span class=n>key_len</span><span class=p>:</span> <span class=mi>180</span>
          <span class=k>ref</span><span class=p>:</span> <span class=n>const</span>
         <span class=k>rows</span><span class=p>:</span> <span class=mi>1</span>
     <span class=n>filtered</span><span class=p>:</span> <span class=mi>100</span><span class=p>.</span><span class=mi>00</span>
        <span class=n>Extra</span><span class=p>:</span> <span class=k>Using</span> <span class=k>index</span>
<span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>1</span> <span class=n>warning</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>可以看到，使用了主键索引，共扫描了一行，<code>Using index</code>表示直接从索引树上查询到结果，无需回表。</p><a class=post-dummy-target id=explain-结果字段说明></a><h4>EXPLAIN 结果字段说明</h4><ul><li><code>select_type</code><ul><li><code>simple</code>：表示不需要<code>UNION</code>操作或者不包含子查询的简单<code>SELECT</code>语句。有连接查询时，外层的查询为<code>simple</code>且只有一个；</li><li><code>primary</code>：一个需要<code>UNION</code>操作或者含有子查询的<code>SELECT</code>，位于最外层的单位查询的<code>select_type</code>即为<code>primary</code>且只有一个；</li><li><code>union</code>：<code>UNION</code>连接的两个<code>SELECT</code>查询，出来第一个表外，第二个以后的表的<code>select_type</code>都是<code>union</code>；</li><li><code>union result</code>：包含<code>UNION</code>的结果集，在<code>UNION</code>和<code>UNION ALL</code>语句中，因为它不需要参与查询，所以<code>id</code>字段为<code>null</code>。</li></ul></li><li><code>table</code><ul><li>显示查询的表名；</li><li>如果不涉及对数据库的操作，这里显示<code>null</code>；</li><li>如果显示为尖括号，就表示这是个临时表，后面的N就是执行计划中的id，表示结果来自于这个查询；</li><li>如果尖括号括起来<code>&lt;union M,N></code>，也是一个临时表，表示这个结果来自于<code>union</code>查询的id为M，N的结果集。</li></ul></li><li><code>type</code><ul><li><code>const</code>：使用唯一索引或主键，返回记录一定是1行记录的等值<code>WHERE</code>条件时，通常<code>type</code>为<code>const</code>；</li><li><code>ref</code>：常见于辅助索引的等值查找，或者多列主键、唯一索引中，使用第一个列之外的列作为等值查找会出现，返回数据不唯一的等值查找也会出现；</li><li><code>range</code>：索引范围扫描，常用于使用<code>&lt;</code>、<code>></code>、<code>IS NULL</code>、<code>BETWEEN</code>、<code>IN</code>、<code>LIKE</code>等运算符的查询中；</li><li><code>index</code>：索引全表扫描，把索引从头到尾扫一遍，常见于使用索引列就可以处理不需要读取文件的查询，可以使用索引排序或分组的查询</li><li><code>all</code>：全表扫描数据文件，然后再server层进行过滤，返回符合要求的记录。</li></ul></li><li><code>ref</code><ul><li>如果使用常数等值查询，这里显示<code>const</code>；</li><li>如果是连接查询，被驱动表的执行计划这里会显示驱动表的关联字段。</li></ul></li><li><code>Extra</code><ul><li><code>Using filesort</code>：排序时无法用到索引，常见于<code>ORDER BY</code>和<code>GROUP BY</code>语句中；</li><li><code>Using index</code>：查询时不需要回表查询，直接通过索引就可以获取查询的数据。</li></ul></li></ul><a class=post-dummy-target id=测试></a><h3>测试</h3><a class=post-dummy-target id=测试1---有无索引进行where过滤的效率></a><h4>测试1 - 有无索引进行WHERE过滤的效率</h4><p>有索引字段搜索和没有索引的字段搜索：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=n>mysql</span><span class=o>&gt;</span> <span class=k>SHOW</span> <span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>student</span><span class=err>\</span><span class=k>G</span>
<span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span> <span class=mi>1</span><span class=p>.</span> <span class=k>row</span> <span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span>
       <span class=k>Table</span><span class=p>:</span> <span class=n>student</span>
<span class=k>Create</span> <span class=k>Table</span><span class=p>:</span> <span class=k>CREATE</span> <span class=k>TABLE</span> <span class=o>`</span><span class=n>student</span><span class=o>`</span> <span class=p>(</span>
  <span class=o>`</span><span class=n>uid</span><span class=o>`</span> <span class=nb>int</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span> <span class=n>unsigned</span> <span class=k>NOT</span> <span class=k>NULL</span> <span class=n>AUTO_INCREMENT</span><span class=p>,</span>
  <span class=o>`</span><span class=n>name</span><span class=o>`</span> <span class=nb>varchar</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
  <span class=o>`</span><span class=n>age</span><span class=o>`</span> <span class=n>tinyint</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=n>unsigned</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
  <span class=o>`</span><span class=n>sex</span><span class=o>`</span> <span class=n>enum</span><span class=p>(</span><span class=s1>&#39;</span><span class=s1>m</span><span class=s1>&#39;</span><span class=p>,</span><span class=s1>&#39;</span><span class=s1>w</span><span class=s1>&#39;</span><span class=p>)</span> <span class=k>NOT</span> <span class=k>NULL</span><span class=p>,</span>
  <span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=p>(</span><span class=o>`</span><span class=n>uid</span><span class=o>`</span><span class=p>)</span>
<span class=p>)</span> <span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span> <span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>7</span> <span class=k>DEFAULT</span> <span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8</span>
<span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>student</span> <span class=k>WHERE</span> <span class=n>uid</span><span class=o>=</span><span class=mi>3</span><span class=p>;</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+-------+---------------+---------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span> <span class=o>|</span> <span class=n>select_type</span> <span class=o>|</span> <span class=k>table</span>   <span class=o>|</span> <span class=n>partitions</span> <span class=o>|</span> <span class=k>type</span>  <span class=o>|</span> <span class=n>possible_keys</span> <span class=o>|</span> <span class=k>key</span>     <span class=o>|</span> <span class=n>key_len</span> <span class=o>|</span> <span class=k>ref</span>   <span class=o>|</span> <span class=k>rows</span> <span class=o>|</span> <span class=n>filtered</span> <span class=o>|</span> <span class=n>Extra</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+-------+---------------+---------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=o>|</span>  <span class=mi>1</span> <span class=o>|</span> <span class=k>SIMPLE</span>      <span class=o>|</span> <span class=n>student</span> <span class=o>|</span> <span class=k>NULL</span>       <span class=o>|</span> <span class=n>const</span> <span class=o>|</span> <span class=k>PRIMARY</span>       <span class=o>|</span> <span class=k>PRIMARY</span> <span class=o>|</span> <span class=mi>4</span>       <span class=o>|</span> <span class=n>const</span> <span class=o>|</span>    <span class=mi>1</span> <span class=o>|</span>   <span class=mi>100</span><span class=p>.</span><span class=mi>00</span> <span class=o>|</span> <span class=k>NULL</span>  <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+-------+---------------+---------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>1</span> <span class=n>warning</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>student</span> <span class=k>WHERE</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;</span><span class=s1>chenwei</span><span class=s1>&#39;</span><span class=p>;</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+------+---------------+------+---------+------+------+----------+-------------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span> <span class=o>|</span> <span class=n>select_type</span> <span class=o>|</span> <span class=k>table</span>   <span class=o>|</span> <span class=n>partitions</span> <span class=o>|</span> <span class=k>type</span> <span class=o>|</span> <span class=n>possible_keys</span> <span class=o>|</span> <span class=k>key</span>  <span class=o>|</span> <span class=n>key_len</span> <span class=o>|</span> <span class=k>ref</span>  <span class=o>|</span> <span class=k>rows</span> <span class=o>|</span> <span class=n>filtered</span> <span class=o>|</span> <span class=n>Extra</span>       <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+------+---------------+------+---------+------+------+----------+-------------+
</span><span class=c1></span><span class=o>|</span>  <span class=mi>1</span> <span class=o>|</span> <span class=k>SIMPLE</span>      <span class=o>|</span> <span class=n>student</span> <span class=o>|</span> <span class=k>NULL</span>       <span class=o>|</span> <span class=k>ALL</span>  <span class=o>|</span> <span class=k>NULL</span>          <span class=o>|</span> <span class=k>NULL</span> <span class=o>|</span> <span class=k>NULL</span>    <span class=o>|</span> <span class=k>NULL</span> <span class=o>|</span>    <span class=mi>5</span> <span class=o>|</span>    <span class=mi>20</span><span class=p>.</span><span class=mi>00</span> <span class=o>|</span> <span class=k>Using</span> <span class=k>where</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+------+---------------+------+---------+------+------+----------+-------------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>1</span> <span class=n>warning</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span> <span class=n>sec</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>有索引字段进行搜索，会直接使用索引，无索引字段搜索会进行整表搜索，效率很低。</p><p>给<code>name</code>字段添加索引：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>student</span> <span class=k>WHERE</span> <span class=n>name</span><span class=o>=</span><span class=s1>&#39;</span><span class=s1>chenwei</span><span class=s1>&#39;</span><span class=p>;</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+------+---------------+---------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span> <span class=o>|</span> <span class=n>select_type</span> <span class=o>|</span> <span class=k>table</span>   <span class=o>|</span> <span class=n>partitions</span> <span class=o>|</span> <span class=k>type</span> <span class=o>|</span> <span class=n>possible_keys</span> <span class=o>|</span> <span class=k>key</span>     <span class=o>|</span> <span class=n>key_len</span> <span class=o>|</span> <span class=k>ref</span>   <span class=o>|</span> <span class=k>rows</span> <span class=o>|</span> <span class=n>filtered</span> <span class=o>|</span> <span class=n>Extra</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+------+---------------+---------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=o>|</span>  <span class=mi>1</span> <span class=o>|</span> <span class=k>SIMPLE</span>      <span class=o>|</span> <span class=n>student</span> <span class=o>|</span> <span class=k>NULL</span>       <span class=o>|</span> <span class=k>ref</span>  <span class=o>|</span> <span class=n>nameidx</span>       <span class=o>|</span> <span class=n>nameidx</span> <span class=o>|</span> <span class=mi>152</span>     <span class=o>|</span> <span class=n>const</span> <span class=o>|</span>    <span class=mi>1</span> <span class=o>|</span>   <span class=mi>100</span><span class=p>.</span><span class=mi>00</span> <span class=o>|</span> <span class=k>NULL</span>  <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+---------+------------+------+---------------+---------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>1</span> <span class=n>warning</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>添加索引后，进行搜索就会使用索引，而不会进行整表搜索。</p><blockquote><p>注意，尽管某个字段使用了索引，但是以该字段过滤进行搜索，并不一定会用到索引。<br>这是由于mysql server进行了优化，如果使用索引和不使用索引的花费大概相当，就不会使用索引，因为使用索引也会引入额外的开销（读索引文件、扫描索引树等等），还不如直接整表扫描。</p></blockquote><a class=post-dummy-target id=测试2---什么情况下不会使用索引></a><h4>测试2 - 什么情况下不会使用索引</h4><p>使用2000000行的<code>user_t</code>表进行测试。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=n>mysql</span><span class=o>&gt;</span> <span class=k>SHOW</span> <span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>user_t</span><span class=err>\</span><span class=k>G</span>
<span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span> <span class=mi>1</span><span class=p>.</span> <span class=k>row</span> <span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span><span class=o>*</span>
       <span class=k>Table</span><span class=p>:</span> <span class=n>user_t</span>
<span class=k>Create</span> <span class=k>Table</span><span class=p>:</span> <span class=k>CREATE</span> <span class=k>TABLE</span> <span class=o>`</span><span class=n>user_t</span><span class=o>`</span> <span class=p>(</span>
  <span class=o>`</span><span class=n>id</span><span class=o>`</span> <span class=nb>int</span><span class=p>(</span><span class=mi>11</span><span class=p>)</span> <span class=n>unsigned</span> <span class=k>NOT</span> <span class=k>NULL</span> <span class=n>AUTO_INCREMENT</span><span class=p>,</span>
  <span class=o>`</span><span class=n>email</span><span class=o>`</span> <span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span> <span class=k>DEFAULT</span> <span class=k>NULL</span><span class=p>,</span>
  <span class=o>`</span><span class=n>passwor</span><span class=o>`</span> <span class=nb>varchar</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span> <span class=k>DEFAULT</span> <span class=k>NULL</span><span class=p>,</span>
  <span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span><span class=p>)</span>
<span class=p>)</span> <span class=n>ENGINE</span><span class=o>=</span><span class=n>InnoDB</span> <span class=n>AUTO_INCREMENT</span><span class=o>=</span><span class=mi>3000001</span> <span class=k>DEFAULT</span> <span class=n>CHARSET</span><span class=o>=</span><span class=n>utf8</span>
<span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>user_t</span> <span class=k>WHERE</span> <span class=n>passwor</span><span class=o>=</span><span class=mi>1000000</span><span class=p>;</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span>      <span class=o>|</span> <span class=n>email</span>            <span class=o>|</span> <span class=n>passwor</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=o>|</span> <span class=mi>2000000</span> <span class=o>|</span> <span class=mi>1000000</span><span class=o>@</span><span class=n>test</span><span class=p>.</span><span class=n>com</span> <span class=o>|</span> <span class=mi>1000000</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>30</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>user_t</span> <span class=k>WHERE</span> <span class=n>passwor</span><span class=o>=</span><span class=mi>1000000</span><span class=p>;</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+------+---------+------+---------+----------+-------------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span> <span class=o>|</span> <span class=n>select_type</span> <span class=o>|</span> <span class=k>table</span>  <span class=o>|</span> <span class=n>partitions</span> <span class=o>|</span> <span class=k>type</span> <span class=o>|</span> <span class=n>possible_keys</span> <span class=o>|</span> <span class=k>key</span>  <span class=o>|</span> <span class=n>key_len</span> <span class=o>|</span> <span class=k>ref</span>  <span class=o>|</span> <span class=k>rows</span>    <span class=o>|</span> <span class=n>filtered</span> <span class=o>|</span> <span class=n>Extra</span>       <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+------+---------+------+---------+----------+-------------+
</span><span class=c1></span><span class=o>|</span>  <span class=mi>1</span> <span class=o>|</span> <span class=k>SIMPLE</span>      <span class=o>|</span> <span class=n>user_t</span> <span class=o>|</span> <span class=k>NULL</span>       <span class=o>|</span> <span class=k>ALL</span>  <span class=o>|</span> <span class=k>NULL</span>          <span class=o>|</span> <span class=k>NULL</span> <span class=o>|</span> <span class=k>NULL</span>    <span class=o>|</span> <span class=k>NULL</span> <span class=o>|</span> <span class=mi>1801249</span> <span class=o>|</span>    <span class=mi>10</span><span class=p>.</span><span class=mi>00</span> <span class=o>|</span> <span class=k>Using</span> <span class=k>where</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+------+---------+------+---------+----------+-------------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>1</span> <span class=n>warning</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>CREATE</span> <span class=k>INDEX</span> <span class=n>pwdidx</span> <span class=k>ON</span> <span class=n>user_t</span><span class=p>(</span><span class=n>passwor</span><span class=p>)</span><span class=p>;</span>
<span class=n>Query</span> <span class=n>OK</span><span class=p>,</span> <span class=mi>0</span> <span class=k>rows</span> <span class=n>affected</span> <span class=p>(</span><span class=mi>1</span><span class=p>.</span><span class=mi>59</span> <span class=n>sec</span><span class=p>)</span>
<span class=n>Records</span><span class=p>:</span> <span class=mi>0</span>  <span class=n>Duplicates</span><span class=p>:</span> <span class=mi>0</span>  <span class=n>Warnings</span><span class=p>:</span> <span class=mi>0</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>user_t</span> <span class=k>WHERE</span> <span class=n>passwor</span><span class=o>=</span><span class=mi>1000000</span><span class=p>;</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span>      <span class=o>|</span> <span class=n>email</span>            <span class=o>|</span> <span class=n>passwor</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=o>|</span> <span class=mi>2000000</span> <span class=o>|</span> <span class=mi>1000000</span><span class=o>@</span><span class=n>test</span><span class=p>.</span><span class=n>com</span> <span class=o>|</span> <span class=mi>1000000</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>31</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>user_t</span> <span class=k>WHERE</span> <span class=n>passwor</span><span class=o>=</span><span class=mi>1000000</span><span class=p>;</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+------+---------+------+---------+----------+-------------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span> <span class=o>|</span> <span class=n>select_type</span> <span class=o>|</span> <span class=k>table</span>  <span class=o>|</span> <span class=n>partitions</span> <span class=o>|</span> <span class=k>type</span> <span class=o>|</span> <span class=n>possible_keys</span> <span class=o>|</span> <span class=k>key</span>  <span class=o>|</span> <span class=n>key_len</span> <span class=o>|</span> <span class=k>ref</span>  <span class=o>|</span> <span class=k>rows</span>    <span class=o>|</span> <span class=n>filtered</span> <span class=o>|</span> <span class=n>Extra</span>       <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+------+---------+------+---------+----------+-------------+
</span><span class=c1></span><span class=o>|</span>  <span class=mi>1</span> <span class=o>|</span> <span class=k>SIMPLE</span>      <span class=o>|</span> <span class=n>user_t</span> <span class=o>|</span> <span class=k>NULL</span>       <span class=o>|</span> <span class=k>ALL</span>  <span class=o>|</span> <span class=n>pwdidx</span>        <span class=o>|</span> <span class=k>NULL</span> <span class=o>|</span> <span class=k>NULL</span>    <span class=o>|</span> <span class=k>NULL</span> <span class=o>|</span> <span class=mi>1801249</span> <span class=o>|</span>    <span class=mi>10</span><span class=p>.</span><span class=mi>00</span> <span class=o>|</span> <span class=k>Using</span> <span class=k>where</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+------+---------+------+---------+----------+-------------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>3</span> <span class=n>warnings</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>在<code>user_t</code>表中使用没有索引的字段<code>passwor</code>作为过滤条件查询，用时0.3s，效率很低。<br>给该字段加上索引，发现还是0.3s，用<code>EXPLAIN</code>查看执行计划，发现，<code>possible_keys</code>项中有<code>pwdidx</code>，但是<code>key</code>项中还是<code>NULL</code>，说明根本没用索引。</p><p>原因其实是因为，过滤字段<code>passwor</code>是字符串，而我们的sql中写成了int类型，mysql server要进行类型转换，这种情况下就不会使用索引了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=n>mysql</span><span class=o>&gt;</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>user_t</span> <span class=k>WHERE</span> <span class=n>passwor</span><span class=o>=</span><span class=s1>&#39;</span><span class=s1>1000000</span><span class=s1>&#39;</span><span class=p>;</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span>      <span class=o>|</span> <span class=n>email</span>            <span class=o>|</span> <span class=n>passwor</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=o>|</span> <span class=mi>2000000</span> <span class=o>|</span> <span class=mi>1000000</span><span class=o>@</span><span class=n>test</span><span class=p>.</span><span class=n>com</span> <span class=o>|</span> <span class=mi>1000000</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>---------+------------------+---------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>

<span class=n>mysql</span><span class=o>&gt;</span> <span class=k>EXPLAIN</span> <span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>user_t</span> <span class=k>WHERE</span> <span class=n>passwor</span><span class=o>=</span><span class=s1>&#39;</span><span class=s1>1000000</span><span class=s1>&#39;</span><span class=p>;</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+--------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=o>|</span> <span class=n>id</span> <span class=o>|</span> <span class=n>select_type</span> <span class=o>|</span> <span class=k>table</span>  <span class=o>|</span> <span class=n>partitions</span> <span class=o>|</span> <span class=k>type</span> <span class=o>|</span> <span class=n>possible_keys</span> <span class=o>|</span> <span class=k>key</span>    <span class=o>|</span> <span class=n>key_len</span> <span class=o>|</span> <span class=k>ref</span>   <span class=o>|</span> <span class=k>rows</span> <span class=o>|</span> <span class=n>filtered</span> <span class=o>|</span> <span class=n>Extra</span> <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+--------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=o>|</span>  <span class=mi>1</span> <span class=o>|</span> <span class=k>SIMPLE</span>      <span class=o>|</span> <span class=n>user_t</span> <span class=o>|</span> <span class=k>NULL</span>       <span class=o>|</span> <span class=k>ref</span>  <span class=o>|</span> <span class=n>pwdidx</span>        <span class=o>|</span> <span class=n>pwdidx</span> <span class=o>|</span> <span class=mi>768</span>     <span class=o>|</span> <span class=n>const</span> <span class=o>|</span>    <span class=mi>1</span> <span class=o>|</span>   <span class=mi>100</span><span class=p>.</span><span class=mi>00</span> <span class=o>|</span> <span class=k>NULL</span>  <span class=o>|</span>
<span class=o>+</span><span class=c1>----+-------------+--------+------------+------+---------------+--------+---------+-------+------+----------+-------+
</span><span class=c1></span><span class=mi>1</span> <span class=k>row</span> <span class=k>in</span> <span class=k>set</span><span class=p>,</span> <span class=mi>1</span> <span class=n>warning</span> <span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span> <span class=n>sec</span><span class=p>)</span>
</code></pre></td></tr></table></div></div></div><div class=post-copyright id=post-footer><p class=copyright-item><span>Author:&nbsp;</span>
<span>xushun</span></p><p class=copyright-item><span>Updated on:&nbsp;</span>
<span>2022-11-04</span></p><p class=copyright-item><span>Share on:&nbsp;</span>
<span><a href="//twitter.com/share?url=https%3a%2f%2fxushun1221.github.io%2f2022%2fmysql11-%25E7%25B4%25A2%25E5%25BC%2595%2f&text=%e3%80%90MySQL%e3%80%9111%20-%20%e7%b4%a2%e5%bc%95&via=" target=_blank title="Share on Twitter"><i class="fab fa-twitter fa-fw"></i></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fxushun1221.github.io%2f2022%2fmysql11-%25E7%25B4%25A2%25E5%25BC%2595%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook-square fa-fw"></i></a><a href="//reddit.com/submit?url=https%3a%2f%2fxushun1221.github.io%2f2022%2fmysql11-%25E7%25B4%25A2%25E5%25BC%2595%2f&title=%e3%80%90MySQL%e3%80%9111%20-%20%e7%b4%a2%e5%bc%95" target=_blank title="Share on Reddit"><i class="fab fa-reddit fa-fw"></i></a></span></p><p class=copyright-item></p><p class=copyright-item></p></div><br><div class=post-info-more><section><span class=tag><a href=https://xushun1221.github.io/tags/datebase/><i class="fas fa-tag fa-fw"></i>&nbsp;datebase</a>&nbsp;
</span><span class=tag><a href=https://xushun1221.github.io/tags/mysql/><i class="fas fa-tag fa-fw"></i>&nbsp;MySQL</a>&nbsp;</span></section><section><span><a href=javascript:window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=https://xushun1221.github.io>Home</a></span></section></div><div class=post-nav><a href=https://xushun1221.github.io/2022/mysql09-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E8%AF%A6%E8%A7%A3/ class=prev rel=prev title="【MySQL】09 - 连接查询详解"><i class="fas fa-angle-left fa-fw"></i>【MySQL】09 - 连接查询详解</a>
<a href=https://xushun1221.github.io/2022/mysql10-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/ class=next rel=next title="【MySQL】10 - 存储引擎">【MySQL】10 - 存储引擎<i class="fas fa-angle-right fa-fw"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright><div class=copyright-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://xushun1221.github.io/about/ target=_blank>xushun</a> | </span>Powered by <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreffer">Hugo</a> & <a href=https://github.com/dillonzq/LoveIt target=_blank rel="external nofollow noopener noreffer">LoveIt</a></div></div></footer></div><a href=# class=dynamic-to-top id=dynamic-to-top data-scroll><span>&nbsp;</span>
</a><script src=/js/lib/jquery/jquery.slim.min.js></script><script src=/js/lib/lazysizes/lazysizes.min.js></script><script src=/js/lib/smooth-scroll/smooth-scroll.polyfills.min.js></script><script>window.scroll=new SmoothScroll('[data-scroll]',{speed:300,speedAsDuration:true});</script><link rel=stylesheet href=/css/lib/katex/katex.min.css><script src=/js/lib/katex/katex.min.js></script><script defer src=/js/lib/katex/auto-render.min.js></script><link rel=stylesheet href=/css/lib/katex/copy-tex.min.css><script defer src=/js/lib/katex/copy-tex.min.js></script><script defer src=/js/lib/katex/mhchem.min.js></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:true},{left:"\\(",right:"\\)",display:false},{left:"\\[",right:"\\]",display:true},{left:"$",right:"$",display:false},]});});</script><script src=/js/blog.min.js></script></body></html>