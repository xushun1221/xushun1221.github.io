---
title: 【算法】有序表 - 实现结构总结
date: 2022-04-30
tags: [算法与数据结构, C++]
categories: [Coding]
---

## 有序表的类型
- 红黑树 - Red Black Tree
- AVL - Adelson-Velsky and Landis 自平衡的搜索二叉树
- SBT - Size Balanced Tree 节点大小平衡树

上述有序表的查找时间复杂度都为：$O\left(logn\right)$。

上述三种结构都属于BST - Binary Search Tree 系列。  
- 跳表 - Skiplist 和上述结构不属于一种类型。

-----

## BST - 搜索二叉树
### 增删改查
- 插入：按左小右大的规则找到插入位置插入即可，搜索二叉树的节点不能重复（key不重复，key相同的元素可以在每个节点中增加数据项）；
- 搜索：按序查找即可；
- 删除：先确定要删除的节点是否在搜索二叉树上
  - 如果要删除的节点无孩子，直接删除；
  - 如果要删除的节点只有一个孩子（左或右），用它的孩子替换它自己即可；
  - 如果要删除的节点有两个孩子，用它左树上最大（最右）的节点或右树上最小（最左）的节点替换它即可。

搜索二叉树的缺点：搜索的时间复杂度取决于数据的状况，好的情况下可以达到$\left(logn\right)$，坏的情况下仅为$\left(n\right)$。原因是没有平衡性。

狭义的平衡性：任一节点左树和右树的高度差不超过1（平衡搜索二叉树 - AVL）；
广义的平衡性：左树和右树的**规模**只要差不多即可，也可以达到$\left(logn\right)$水平。

-----

## 左旋、右旋
左旋和右旋是搜索二叉树中的一种操作，具有这种操作的搜索二叉树就具有了自平衡性，AVL、红黑树、SBT等的区别在于平衡性的标准不同以及如何使用左旋和右旋进行平衡调整。  
![](/post_images/posts/Coding/算法-有序表/左旋右旋和树的关系.jpg "左旋右旋和树的关系")

左旋：
![](/post_images/posts/Coding/算法-有序表/左旋.jpg "左旋")

右旋：
![](/post_images/posts/Coding/算法-有序表/右旋.jpg "右旋")

当平衡搜索二叉树插入或删除节点时，可能导致平衡性被破坏，此时使用左旋或右旋操作来保持平衡性。

-----

## AVL - 平衡搜索二叉树
### 如何发现平衡性失效 - AVL树的检查时机：
- 当插入节点时，插入完成后，从当前插入节点位置开始，不断向上，依次查询以当前节点为根的树是否平衡，如不平衡就执行左旋或右旋操作，直到整棵树都恢复平衡性；
- 当删除节点时，如果要删除的节点不同时有左右孩子，就从删除位置开始向上检查即可，如果要删除的节点同时有左右孩子，此时需要用子树（左或右）上的某个节点`x`替换它，从`x`的父节点出发依次向上检查即可。

### 平衡条件 - 高度
左右子树高度差小于等于1。

### 平衡性被破坏的四种情况和调整方法
假设当前平衡性失效的节点为`x`：
1. LL型-`x`左孩子的左树过高：`x`右旋；
2. RR型-`x`右孩子的右树过高：`x`左旋；
3. LR型-`x`左孩子的右树过高：`x`左孩子左旋，`x`右旋；
4. RL型-`x`右孩子的左树过高：`x`右孩子右旋，`x`左旋。

整体的调整代价为$O\left(logn\right)$。

红黑树、SBT，它们与AVL的增删改查操作和检查时机完全相同，不同点在于平衡条件和调整方法不同（调整同样使用左旋右旋操作）。

-----

## SBT - Size Balanced Tree
### 平衡条件 - Size
每棵子树`x`的大小（节点个数），不小于其兄弟（`x`的兄弟）的子树大小。  
![](/post_images/posts/Coding/算法-有序表/SBT的平衡条件.jpg "SBT的平衡条件")
（D、E、F、G同理）

### 平衡性被破坏的四种情况和调整方法
假设当前平衡性失效的节点为`x`：
1. LL型-`x`左孩子的左树大于`x`的右树：（递归过程）`x`右旋，检查所有孩子节点指针有改变的节点是否平衡，重复调整；
2. RR型-`x`右孩子的右树大于`x`的左树：（递归过程）`x`左旋，同上检查；
3. LR型-`x`左孩子的右树大于`x`的右树：（递归过程）`x`左孩子左旋，`x`右旋，同上检查；
4. RL型-`x`右孩子的左树大于`x`的左树：（递归过程）`x`右孩子右旋，`x`左旋，同上检查。

-----

## 红黑树 - Red Black Tree
### 平衡条件 - 颜色
1. 红黑树中每个节点都有颜色，要么红，要么黑；
2. 根节点和叶子节点（最底层的空节点，不是无孩子的节点）必须为黑色；
3. 任何两个红色节点不能相邻；
4. 对从任何一棵子树根`cur`出发，到它的叶节点的每一条路径，要求黑节点数量一样；

想要达成的目标是，所有路径的长度差别不会很大（最多差一倍：红黑交替 - 全黑）。

### 平衡性被破坏情况和调整方法
略。